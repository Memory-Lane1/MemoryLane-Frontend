{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/jaskaran/Desktop/poogle/Poogle/src/components/chat/Chat.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport \"./Chat.css\";\nimport { Button } from 'reactstrap';\nimport { Container, Row, Col, Form, Tab, Tabs, Nav, ListGroup, ListGroupItem, Image } from \"react-bootstrap\";\nimport questionMan from \"../../Images/chat-bubbles.webp\";\nimport ChatSideBar from \"./ChatSideBar\";\nimport { getChats, sendMessage } from \"../../redux/actions/chat\";\nimport { baseUrl } from \"../../shared/baseUrl\";\nimport { connect } from \"react-redux\";\nimport background from \"../../Images/chat_back.jpg\";\nimport Modal from \"react-modal\";\nimport { spaces } from \"../variables\";\nimport { FaSearch } from \"react-icons/fa\";\n\nconst axios = require(\"axios\");\n\nconst Pusher = require(\"pusher-js\");\n\nconst Chat = ({\n  chats,\n  token,\n  dispatch\n}) => {\n  _s();\n\n  console.log(chats);\n  const [person, setPerson] = useState(\"\");\n  const [chat, setChat] = useState([]);\n  const [msg, setMsg] = useState(\"\");\n  const [modalOpen, setModalOpen] = useState(false);\n  const [currSpace, setCurrSpace] = useState(\"\");\n  const [newPerson, setNewPerson] = useState(\"\");\n  const [search, setSearch] = useState(\"\");\n  const [newPersonId, setNewPersonId] = useState(\"\");\n  const [users, setUsers] = useState([]);\n  useEffect(() => {\n    const width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n    const height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n    if (width <= 1200) alert(\"Chat is preferred to be used on large screen for better experience\");\n    const pusher = new Pusher(\"563987a4f9fd4750ba5e\", {\n      cluster: \"ap2\"\n    });\n    const channel = pusher.subscribe(\"messages\");\n    channel.bind(\"inserted\", data => {\n      dispatch(getChats(token));\n    });\n  }, []);\n\n  const toggle = () => {\n    setModalOpen(false);\n  };\n\n  useEffect(() => {\n    dispatch(getChats(token));\n  }, []);\n  useEffect(() => {\n    setMsg(\"\");\n  }, [person]);\n  useEffect(() => {\n    var list = document.getElementById(\"list\");\n    if (list) list.scrollTop = list.scrollHeight;\n  }, [person, chat]);\n\n  const handleMessageSent = e => {\n    e.preventDefault();\n    if (msg === \"\") return;\n    setChat(chat => [...chat, {\n      msg,\n      sender: \"me\"\n    }]);\n    const id = newPerson === person ? newPersonId : chats.chats.filter(({\n      name\n    }) => person === name)[0]._id;\n    console.log(token, msg, id);\n    dispatch(sendMessage(token, msg, id));\n    setMsg(\"\");\n  };\n\n  const handleMsgChange = e => {\n    e.preventDefault();\n    setMsg(e.target.value);\n  };\n\n  const handleCurrSpace = async e => {\n    setCurrSpace(e.target.innerHTML);\n    const user = await axios({\n      method: \"get\",\n      url: baseUrl + \"users\",\n      params: {\n        interests: e.target.innerHTML\n      }\n    });\n    console.log(user);\n    setUsers(user.data);\n  };\n\n  const handleNewChat = e => {\n    console.log(e.target.innerHTML);\n    console.log(e.target.getAttribute(\"id\"));\n    setNewPersonId(e.target.getAttribute(\"id\"));\n    console.log(e.target);\n    setCurrSpace(\"\");\n    setNewPerson(e.target.innerHTML);\n    setChat([]);\n    setUsers([]);\n    setPerson(e.target.innerHTML);\n    setModalOpen(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    style: {\n      height: \"80vh\",\n      marginTop: \"20px\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: modalOpen,\n      style: {\n        overlay: {\n          zIndex: 1000010\n        }\n      },\n      children: [/*#__PURE__*/_jsxDEV(Row, {\n        style: {\n          width: \"100%\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(FaSearch, {\n          style: {\n            margin: \"12px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Search person\",\n          value: search,\n          style: {\n            border: \"none\",\n            outlineWidth: \"0\",\n            background: \"transparent\",\n            padding: \"10px\"\n          },\n          onChange: e => {\n            setSearch(e.target.value);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, this), search !== \"\" && currSpace === \"\" ? /*#__PURE__*/_jsxDEV(ListGroup, {\n        style: {\n          width: \"100%\"\n        },\n        children: spaces.filter(({\n          value\n        }) => value.toLowerCase().includes(search.toLowerCase())).map(space => /*#__PURE__*/_jsxDEV(ListGroupItem, {\n          children: /*#__PURE__*/_jsxDEV(Nav.Link, {\n            onClick: handleCurrSpace,\n            children: space.value\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 19\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 17\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 11\n      }, this) : currSpace === \"\" ? /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Search for spaces\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 11\n      }, this), currSpace === \"\" ? /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 29\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Showing results for, \", currSpace]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 37\n      }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n        children: users.map(user => /*#__PURE__*/_jsxDEV(ListGroupItem, {\n          children: /*#__PURE__*/_jsxDEV(Nav.Link, {\n            onClick: handleNewChat,\n            id: user._id,\n            children: user.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: toggle,\n        color: \"danger\",\n        className: \"mt-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \" mr-3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 66\n        }, this), \"Close\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      style: {\n        maxHeight: \"60vh\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(ChatSideBar, {\n        person: person,\n        setPerson: setPerson,\n        chat: chat,\n        setChat: setChat,\n        modalOpen: modalOpen,\n        setModalOpen: setModalOpen,\n        newPerson: newPerson\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        xs: 6,\n        md: 8,\n        children: person === \"\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"CHOOSE YOUR MENTOR\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Image, {\n            src: questionMan,\n            className: \"header__side__manimage\",\n            fluid: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(Row, {\n            style: {\n              padding: \"10px\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"justify-content-end\",\n              style: {\n                overflowY: \"scroll\",\n                height: \"74vh\",\n                width: \"100%\",\n                backgroundImage: {\n                  background\n                },\n                backgroundRepeat: \"repeat\",\n                backgroundPosition: \"center\"\n              },\n              id: \"list\",\n              children: chat.map(({\n                msg,\n                sender,\n                createdAt\n              }) => /*#__PURE__*/_jsxDEV(\"div\", {\n                class: `${sender === \"me\" ? \"sending__msg\" : \"\"}`,\n                style: {\n                  maxWidth: \"50%\",\n                  wordBreak: \"break-all\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `rounded px-2 py-1 ${sender === \"me\" ? \"bg-primary text-white\" : \"border\"}`,\n                  style: {\n                    margin: \"10px\"\n                  },\n                  children: msg\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `text-muted small text-left`,\n                  children: createdAt\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 220,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `text-muted small text-right`,\n                  children: sender === \"me\" ? \"You\" : person\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 223,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 208,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Row, {\n            children: /*#__PURE__*/_jsxDEV(Form, {\n              style: {\n                bottom: \"10px\",\n                width: \"85%\",\n                margin: \"auto\"\n              },\n              onSubmit: handleMessageSent,\n              children: /*#__PURE__*/_jsxDEV(Form.Control, {\n                placeholder: \"Type your message (right click cursor to insert emojies)\",\n                value: msg,\n                onChange: handleMsgChange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 122,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Chat, \"vyTuhRlVRizOhqgSy7NXWGTxi/A=\");\n\n_c = Chat;\n\nconst mapStateToProps = state => {\n  return {\n    chats: state.chats,\n    token: state.auth.token\n  };\n};\n\nexport default connect(mapStateToProps)(Chat);\n\nvar _c;\n\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"sources":["/home/jaskaran/Desktop/poogle/Poogle/src/components/chat/Chat.js"],"names":["React","useEffect","useState","Button","Container","Row","Col","Form","Tab","Tabs","Nav","ListGroup","ListGroupItem","Image","questionMan","ChatSideBar","getChats","sendMessage","baseUrl","connect","background","Modal","spaces","FaSearch","axios","require","Pusher","Chat","chats","token","dispatch","console","log","person","setPerson","chat","setChat","msg","setMsg","modalOpen","setModalOpen","currSpace","setCurrSpace","newPerson","setNewPerson","search","setSearch","newPersonId","setNewPersonId","users","setUsers","width","window","innerWidth","document","documentElement","clientWidth","body","height","innerHeight","clientHeight","alert","pusher","cluster","channel","subscribe","bind","data","toggle","list","getElementById","scrollTop","scrollHeight","handleMessageSent","e","preventDefault","sender","id","filter","name","_id","handleMsgChange","target","value","handleCurrSpace","innerHTML","user","method","url","params","interests","handleNewChat","getAttribute","marginTop","overlay","zIndex","margin","border","outlineWidth","padding","toLowerCase","includes","map","space","maxHeight","overflowY","backgroundImage","backgroundRepeat","backgroundPosition","createdAt","maxWidth","wordBreak","bottom","mapStateToProps","state","auth"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport \"./Chat.css\";\nimport { Button } from 'reactstrap';\nimport {\n  Container,\n  Row,\n  Col,\n  Form,\n  Tab,\n  Tabs,\n  Nav,\n  ListGroup,\n  ListGroupItem,\n  Image\n} from \"react-bootstrap\";\nimport questionMan from \"../../Images/chat-bubbles.webp\";\nimport ChatSideBar from \"./ChatSideBar\";\nimport { getChats, sendMessage } from \"../../redux/actions/chat\";\nimport { baseUrl } from \"../../shared/baseUrl\";\nimport { connect } from \"react-redux\";\nimport background from \"../../Images/chat_back.jpg\";\nimport Modal from \"react-modal\";\nimport { spaces } from \"../variables\";\nimport { FaSearch } from \"react-icons/fa\";\nconst axios = require(\"axios\");\nconst Pusher = require(\"pusher-js\");\n\nconst Chat = ({ chats, token, dispatch }) => {\n  console.log(chats);\n  const [person, setPerson] = useState(\"\");\n  const [chat, setChat] = useState([]);\n  const [msg, setMsg] = useState(\"\");\n  const [modalOpen, setModalOpen] = useState(false);\n  const [currSpace, setCurrSpace] = useState(\"\");\n  const [newPerson, setNewPerson] = useState(\"\");\n  const [search, setSearch] = useState(\"\");\n  const [newPersonId, setNewPersonId] = useState(\"\");\n  const [users, setUsers] = useState([]);\n\n  useEffect(() => {\n\n    const width  = window.innerWidth || document.documentElement.clientWidth || \n    document.body.clientWidth;\n    const height = window.innerHeight|| document.documentElement.clientHeight|| \n    document.body.clientHeight;\n\n    if(width <= 1200)\n      alert(\"Chat is preferred to be used on large screen for better experience\");\n\n    const pusher = new Pusher(\"563987a4f9fd4750ba5e\", {\n      cluster: \"ap2\",\n    });\n\n    const channel = pusher.subscribe(\"messages\");\n    channel.bind(\"inserted\", (data) => {\n      dispatch(getChats(token));\n    });\n  }, []);\n\n  const toggle = () => {\n    setModalOpen(false);\n  }\n\n  useEffect(() => {\n    dispatch(getChats(token));\n  }, []);\n\n  useEffect(() => {\n    setMsg(\"\");\n  }, [person]);\n\n  useEffect(() => {\n    var list = document.getElementById(\"list\");\n    if (list) list.scrollTop = list.scrollHeight;\n  }, [person, chat]);\n\n  const handleMessageSent = (e) => {\n    e.preventDefault();\n    if (msg === \"\") return;\n    setChat((chat) => [...chat, { msg, sender: \"me\" }]);\n    const id =\n      newPerson === person\n        ? newPersonId\n        : chats.chats.filter(({ name }) => person === name)[0]._id;\n    console.log(token, msg, id);\n    dispatch(sendMessage(token, msg, id));\n    setMsg(\"\");\n  };\n\n  const handleMsgChange = (e) => {\n    e.preventDefault();\n    setMsg(e.target.value);\n  };\n\n  const handleCurrSpace = async (e) => {\n    setCurrSpace(e.target.innerHTML);\n    const user = await axios({\n      method: \"get\",\n      url: baseUrl + \"users\",\n      params: {\n        interests: e.target.innerHTML,\n      },\n    });\n    console.log(user);\n    setUsers(user.data);\n  };\n\n  const handleNewChat = (e) => {\n    console.log(e.target.innerHTML);\n    console.log(e.target.getAttribute(\"id\"));\n    setNewPersonId(e.target.getAttribute(\"id\"));\n    console.log(e.target);\n    setCurrSpace(\"\");\n    setNewPerson(e.target.innerHTML);\n    setChat([]);\n    setUsers([]);\n    setPerson(e.target.innerHTML);\n    setModalOpen(false);\n  };\n\n  return (\n    <Container style={{ height: \"80vh\", marginTop: \"20px\" }}>\n      <Modal isOpen={modalOpen} style={{ overlay: { zIndex: 1000010 } }}>\n        <Row style={{ width: \"100%\" }}>\n          <FaSearch style={{ margin: \"12px\" }} />\n          <input\n            type=\"text\"\n            placeholder=\"Search person\"\n            value={search}\n            style={{\n              border: \"none\",\n              outlineWidth: \"0\",\n              background: \"transparent\",\n              padding: \"10px\",\n            }}\n            onChange={(e) => {\n              setSearch(e.target.value);\n            }}\n          ></input>\n        </Row>\n        {search !== \"\" && currSpace === \"\" ? (\n          <ListGroup style={{ width: \"100%\" }}>\n            {spaces\n              .filter(({ value }) =>\n                value.toLowerCase().includes(search.toLowerCase())\n              )\n              .map((space) => (\n                <ListGroupItem>\n                  <Nav.Link onClick={handleCurrSpace}>{space.value}</Nav.Link>\n                </ListGroupItem>\n              ))}\n          </ListGroup>\n        ) : currSpace === \"\" ? (\n          <h1>Search for spaces</h1>\n        ) : (\n          <p></p>\n        )}\n        {currSpace === \"\" ? <p /> : <p>Showing results for, {currSpace}</p>}\n        <ListGroup>\n          {users.map((user) => (\n            <ListGroupItem>\n              <Nav.Link onClick={handleNewChat} id={user._id}>\n                {user.name}\n              </Nav.Link>\n            </ListGroupItem>\n          ))}\n        </ListGroup>\n        <Button onClick={toggle} color=\"danger\" className='mt-2'><span className=' mr-3' />Close</Button>\n      </Modal>\n      <Row style={{ maxHeight: \"60vh\" }}>\n        {/*Chat sidebar*/}\n        <ChatSideBar\n          person={person}\n          setPerson={setPerson}\n          chat={chat}\n          setChat={setChat}\n          modalOpen={modalOpen}\n          setModalOpen={setModalOpen}\n          newPerson={newPerson}\n        />\n        {/*Chat section*/}\n        <Col xs={6} md={8}>\n          {person === \"\" ? (\n            <div>\n              <h4>CHOOSE YOUR MENTOR</h4>\n              <Image\n                src={questionMan}\n                className=\"header__side__manimage\"\n                fluid\n              />\n            </div>\n          ) : (\n            <div>\n              <Row style={{ padding: \"10px\" }}>\n                <div\n                  className=\"justify-content-end\"\n                  style={{\n                    overflowY: \"scroll\",\n                    height: \"74vh\",\n                    width: \"100%\",\n                    backgroundImage: { background },\n                    backgroundRepeat: \"repeat\",\n                    backgroundPosition: \"center\",\n                  }}\n                  id=\"list\"\n                >\n                  {chat.map(({ msg, sender, createdAt }) => (\n                    <div\n                      class={`${sender === \"me\" ? \"sending__msg\" : \"\"}`}\n                      style={{ maxWidth: \"50%\", wordBreak: \"break-all\" }}\n                    >\n                      <div\n                        className={`rounded px-2 py-1 ${\n                          sender === \"me\" ? \"bg-primary text-white\" : \"border\"\n                        }`}\n                        style={{ margin: \"10px\" }}\n                      >\n                        {msg}\n                      </div>\n                      <div className={`text-muted small text-left`}>\n                        {createdAt}\n                      </div>\n                      <div className={`text-muted small text-right`}>\n                        {sender === \"me\" ? \"You\" : person}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </Row>\n              <Row>\n                <Form\n                  style={{\n                    bottom: \"10px\",\n                    width: \"85%\",\n                    margin: \"auto\",\n                  }}\n                  onSubmit={handleMessageSent}\n                >\n                  <Form.Control\n                    placeholder=\"Type your message (right click cursor to insert emojies)\"\n                    value={msg}\n                    onChange={handleMsgChange}\n                  />\n                </Form>\n              </Row>\n            </div>\n          )}\n        </Col>\n      </Row>\n    </Container>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return { chats: state.chats, token: state.auth.token };\n};\n\nexport default connect(mapStateToProps)(Chat);\n"]},"metadata":{},"sourceType":"module"}